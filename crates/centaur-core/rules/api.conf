SecRuleEngine On
SecDebugLog /tmp/waf-api.log

# Строгие правила для API
SecRule REQUEST_METHOD "!@within GET,POST,PUT,DELETE" \
    "id:1001,phase:1,deny,msg:'Invalid HTTP method for API'"

SecRule ARGS "@validateByteRange 32-126" \
    "id:1002,phase:1,deny,msg:'Non-ASCII characters in API request'"

SecRule REQUEST_HEADERS:Content-Type "!@startsWith application/json" \
    "id:1003,phase:1,deny,msg:'API requires JSON content type'"

SecRule REQUEST_URI "@contains /profile" "id:1004,phase:1,deny,status:403,msg:'Block profile access'"
